{% extends 'base.html' %}

{% block title %}Doctor Applications - Swasth Setu{% endblock %}

{% block content %}
<h1 style="margin-bottom: 1.5rem;">Doctor Applications</h1>

<div style="margin-bottom: 1.5rem;">
    <a href="?status=all" class="btn {% if status_filter == 'all' %}btn-primary{% else %}btn-secondary{% endif %}" style="padding: 0.5rem 1rem;">All</a>
    <a href="?status=pending" class="btn {% if status_filter == 'pending' %}btn-primary{% else %}btn-secondary{% endif %}" style="padding: 0.5rem 1rem;">Pending</a>
    <a href="?status=approved" class="btn {% if status_filter == 'approved' %}btn-primary{% else %}btn-secondary{% endif %}" style="padding: 0.5rem 1rem;">Approved</a>
    <a href="?status=rejected" class="btn {% if status_filter == 'rejected' %}btn-primary{% else %}btn-secondary{% endif %}" style="padding: 0.5rem 1rem;">Rejected</a>
</div>

<table>
    <thead>
        <tr>
            <th>ID</th>
            <th>Applicant</th>
            <th>Email</th>
            <th>Specialty</th>
            <th>Experience</th>
            <th>Fee</th>
            <th>Status</th>
            <th>Applied</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for app in applications %}
        <tr>
            <td>{{ app.id }}</td>
            <td>{{ app.user.get_full_name|default:app.user.username }}</td>
            <td>{{ app.user.email }}</td>
            <td>{{ app.specialty }}</td>
            <td>{{ app.experience }} years</td>
            <td>â‚¹{{ app.fee }}</td>
            <td>
                {% if app.status == 'pending' %}<span class="badge badge-warning">Pending</span>
                {% elif app.status == 'approved' %}<span class="badge badge-success">Approved</span>
                {% else %}<span class="badge badge-danger">Rejected</span>{% endif %}
            </td>
            <td>{{ app.created_at|date:"M d, Y" }}</td>
            <td>
                {% if app.status == 'pending' %}
                <a href="{% url 'admin_approve_doctor' app.id %}" class="btn btn-success" style="padding: 0.5rem 1rem; font-size: 0.85rem; margin-right: 0.5rem;">Approve</a>
                <a href="{% url 'admin_reject_application' 'doctor' app.id %}" class="btn btn-danger" style="padding: 0.5rem 1rem; font-size: 0.85rem;">Reject</a>
                {% else %}
                <span style="color: #999;">-</span>
                {% endif %}
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="9" style="text-align: center; padding: 2rem;">No applications found.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<div style="margin-top: 1.5rem;">
    {% if applications.has_previous %}
    <a href="?page={{ applications.previous_page_number }}&status={{ status_filter }}" class="btn btn-secondary">Previous</a>
    {% endif %}
    <span style="margin: 0 1rem;">Page {{ applications.number }} of {{ applications.paginator.num_pages }}</span>
    {% if applications.has_next %}
    <a href="?page={{ applications.next_page_number }}&status={{ status_filter }}" class="btn btn-secondary">Next</a>
    {% endif %}
</div>
{% endblock %}

